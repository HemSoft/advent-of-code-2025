#lang rhombus/static

fun parse_rotation(line :: String):
  def direction = line.substring(0, 1)
  def amount = line.substring(1..).to_int()
  values(direction, amount)

fun apply_rotation(pos, direction, amount):
  if direction == "L"
  | (pos - amount + 100) mod 100
  | (pos + amount) mod 100

fun count_zeros_during(pos, direction, amount):
  def mutable count = 0
  def mutable current = pos
  for (i in 0..amount):
    def new_val:
      if direction == "L"
      | (current - 1 + 100) mod 100
      | (current + 1) mod 100
    current := new_val
    when current == 0
    | count := count + 1
  count

fun main():
  def lines = filesystem.read_lines("input.txt")

  def mutable position = 50
  def mutable part1_count = 0

  for (line in lines):
    when line.length() > 0
    | def (direction, amount) = parse_rotation(line)
      position := apply_rotation(position, direction, amount)
      when position == 0
      | part1_count := part1_count + 1

  println("Day 01 Part 1: " ++ to_string(part1_count))

  position := 50
  def mutable part2_count = 0

  for (line in lines):
    when line.length() > 0
    | def (direction, amount) = parse_rotation(line)
      part2_count := part2_count + count_zeros_during(position, direction, amount)
      position := apply_rotation(position, direction, amount)

  println("Day 01 Part 2: " ++ to_string(part2_count))

main()
